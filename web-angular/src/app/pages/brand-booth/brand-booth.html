<!-- Loading Overlay -->
@if (loading()) {
<div class="fixed inset-0 z-50 flex items-center justify-center bg-background/80 backdrop-blur-sm transition-opacity">
    <div class="flex flex-col items-center gap-4">
        <div class="relative w-16 h-16">
            <div class="absolute inset-0 rounded-full border-4 border-primary/20"></div>
            <div class="absolute inset-0 rounded-full border-4 border-primary border-t-transparent animate-spin">
            </div>
            <lucide-icon [name]="Sparkles"
                class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-6 h-6 text-primary animate-pulse"></lucide-icon>
        </div>
        <p class="text-lg font-medium text-foreground animate-pulse">جاري التحميل...</p>
    </div>
</div>
}

@if (brand(); as brand) {
<div class="min-h-screen">
    <!-- Brand Header -->
    <section class="pt-24 pb-12 px-4">
        <div class="container mx-auto">
            <!-- Back Button -->
            <a routerLink="/"
                class="inline-flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-8">
                <lucide-icon [name]="ArrowRight" class="w-4 h-4"></lucide-icon>
                العودة إلى قاعة المعارض
            </a>

            <!-- Brand Hero -->
            <div class="booth-card p-8 md:p-12 relative overflow-hidden">
                <!-- Brand Accent Bar -->
                <div class="absolute top-0 left-0 right-0 h-2"
                    [style.background]="'linear-gradient(270deg, hsl(' + brand.color + ') 0%, hsl(' + brand.color + ' / 0.4) 100%)'">
                </div>

                <div class="flex flex-col md:flex-row items-start gap-8">
                    <!-- Brand Logo -->
                    <div class="w-28 h-28 rounded-2xl overflow-hidden border-4 flex-shrink-0"
                        [style.borderColor]="'hsl(' + brand.color + ')'">
                        @if (brand.logoUrl) {
                        <img [src]="brand.logoUrl" [alt]="brand.name" class="w-full h-full object-cover" />
                        } @else {
                        <div
                            class="w-full h-full flex items-center justify-center bg-accent text-foreground text-3xl font-bold">
                            {{ brand.name.charAt(0) }}
                        </div>
                        }
                    </div>

                    <!-- Brand Info -->
                    <div class="flex-1">
                        <h1 class="font-display text-4xl md:text-5xl font-bold text-foreground mb-3">
                            {{ brand.name }}
                        </h1>
                        <p class="text-xl text-muted-foreground mb-4">
                            {{ brand.tagline || brand.description || 'علامة تجارية مميزة' }}
                        </p>
                        @if (brand.description) {
                        <p class="text-muted-foreground mb-4">
                            {{ brand.description }}
                        </p>
                        }
                        <div class="flex flex-wrap gap-3">
                            @if (brand.websiteUrl) {
                            <a appButton variant="gold" [href]="brand.websiteUrl" target="_blank"
                                rel="noopener noreferrer"
                                [style.background]="'linear-gradient(135deg, hsl(' + brand.color + ') 0%, hsl(' + brand.color + ' / 0.8) 100%)'">
                                زيارة الموقع
                                <lucide-icon [name]="ExternalLink" class="w-4 h-4"></lucide-icon>
                            </a>
                            }
                            <button appButton variant="glass">
                                <lucide-icon [name]="Share2" class="w-4 h-4"></lucide-icon>
                                مشاركة الجناح
                            </button>
                        </div>

                        <!-- Social Links -->
                        @if (brand.facebookUrl || brand.instagramUrl || brand.twitterUrl || brand.linkedInUrl) {
                        <div class="flex flex-wrap gap-3 mt-4">
                            @if (brand.facebookUrl) {
                            <a [href]="brand.facebookUrl" target="_blank" rel="noopener noreferrer"
                                class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white hover:bg-blue-700 transition-colors"
                                title="Facebook">
                                <lucide-icon [name]="Facebook" class="w-5 h-5"></lucide-icon>
                            </a>
                            }
                            @if (brand.instagramUrl) {
                            <a [href]="brand.instagramUrl" target="_blank" rel="noopener noreferrer"
                                class="w-10 h-10 rounded-full bg-gradient-to-tr from-yellow-500 via-pink-500 to-purple-600 flex items-center justify-center text-white hover:opacity-90 transition-opacity"
                                title="Instagram">
                                <lucide-icon [name]="Instagram" class="w-5 h-5"></lucide-icon>
                            </a>
                            }
                            @if (brand.twitterUrl) {
                            <a [href]="brand.twitterUrl" target="_blank" rel="noopener noreferrer"
                                class="w-10 h-10 rounded-full bg-black flex items-center justify-center text-white hover:bg-gray-800 transition-colors"
                                title="X / Twitter">
                                <lucide-icon [name]="Twitter" class="w-5 h-5"></lucide-icon>
                            </a>
                            }
                            @if (brand.linkedInUrl) {
                            <a [href]="brand.linkedInUrl" target="_blank" rel="noopener noreferrer"
                                class="w-10 h-10 rounded-full bg-blue-700 flex items-center justify-center text-white hover:bg-blue-800 transition-colors"
                                title="LinkedIn">
                                <lucide-icon [name]="Linkedin" class="w-5 h-5"></lucide-icon>
                            </a>
                            }
                        </div>
                        }
                    </div>
                </div>

                <!-- Decorative Elements -->
                <div class="absolute bottom-0 left-0 w-64 h-64 opacity-10"
                    [style.background]="'radial-gradient(circle at bottom left, hsl(' + brand.color + '), transparent)'">
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="py-12 px-4">
        <div class="container mx-auto">
            <div class="flex justify-between items-center mb-8">
                <h2 class="font-display text-2xl md:text-3xl font-bold text-foreground">
                    المنتجات ({{ brand.products.length }})
                </h2>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                @for (product of brand.products; track product.id; let index = $index) {
                    <div class="animate-fade-in" [style.animationDelay]="(index * 50) + 'ms'">
                        <div class="product-card block group overflow-hidden">
                            <a [routerLink]="['/product', product.id]" class="block">
                                <div class="aspect-square overflow-hidden">
                                    @if (product.imageUrl) {
                                    <img [src]="product.imageUrl" [alt]="product.name"
                                        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                                        loading="lazy" />
                                    } @else {
                                    <div
                                        class="w-full h-full flex items-center justify-center bg-accent text-muted-foreground text-2xl">
                                        {{ product.name.charAt(0) }}
                                    </div>
                                    }
                                </div>
                                <div class="p-4">
                                    <h3 class="font-semibold text-foreground mb-1">
                                        {{ product.name }}
                                    </h3>
                                    @if (product.description) {
                                    <p class="text-muted-foreground text-sm">
                                        {{ product.description }}
                                    </p>
                                    }
                                </div>
                            </a>

                            @if (product.facebookUrl || product.instagramUrl || product.twitterUrl || product.linkedInUrl) {
                            <div class="px-4 pb-4 flex items-center gap-2">
                                @if (product.facebookUrl) {
                                <a [href]="product.facebookUrl" target="_blank" rel="noopener noreferrer"
                                    class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center hover:bg-blue-700 transition-colors"
                                    title="Facebook" aria-label="Facebook">
                                    <lucide-icon [name]="Facebook" class="w-4 h-4"></lucide-icon>
                                </a>
                                }
                                @if (product.instagramUrl) {
                                <a [href]="product.instagramUrl" target="_blank" rel="noopener noreferrer"
                                    class="w-8 h-8 rounded-full bg-gradient-to-tr from-yellow-500 via-pink-500 to-purple-600 text-white flex items-center justify-center hover:opacity-90 transition-opacity"
                                    title="Instagram" aria-label="Instagram">
                                    <lucide-icon [name]="Instagram" class="w-4 h-4"></lucide-icon>
                                </a>
                                }
                                @if (product.twitterUrl) {
                                <a [href]="product.twitterUrl" target="_blank" rel="noopener noreferrer"
                                    class="w-8 h-8 rounded-full bg-black text-white flex items-center justify-center hover:bg-gray-800 transition-colors"
                                    title="X / Twitter" aria-label="X / Twitter">
                                    <lucide-icon [name]="Twitter" class="w-4 h-4"></lucide-icon>
                                </a>
                                }
                                @if (product.linkedInUrl) {
                                <a [href]="product.linkedInUrl" target="_blank" rel="noopener noreferrer"
                                    class="w-8 h-8 rounded-full bg-blue-700 text-white flex items-center justify-center hover:bg-blue-800 transition-colors"
                                    title="LinkedIn" aria-label="LinkedIn">
                                    <lucide-icon [name]="Linkedin" class="w-4 h-4"></lucide-icon>
                                </a>
                                }
                            </div>
                            }

                            <div class="h-1 w-0 transition-all duration-300 group-hover:w-full"
                                [style.background]="'hsl(' + brand.color + ')'">
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </section>

    <!-- Back to Hall CTA -->
    <section class="py-12 px-4">
        <div class="container mx-auto text-center">
            <a routerLink="/">
                <button appButton variant="outline" size="lg">
                    <lucide-icon [name]="ArrowRight" class="w-4 h-4"></lucide-icon>
                    استكشف أجنحة أخرى
                </button>
            </a>
        </div>
    </section>
</div>
} @else {
<div class="min-h-screen flex items-center justify-center">
    <div class="text-center">
        <h1 class="font-display text-2xl font-bold text-foreground mb-4">
            العلامة التجارية غير موجودة
        </h1>
        <a routerLink="/" class="text-primary hover:underline">
            العودة إلى قاعة المعارض
        </a>
    </div>
</div>
}
